<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0">   take back control of responsiveness -->
	<meta name="description" content="Histogram stuff" />

    <meta name="author" content="Aran Lunzer and Amelia McNamara">
    <title>Exploring Histograms</title>
    <!--<link rel="stylesheet" href="dist/font-awesome/css/font-awesome.min.css"> -->
   <!-- <link href="dist/css/bootstrap.min.css" rel="stylesheet"> -->
    <link href="styles/my.css" rel="stylesheet">
    <link href="styles/scrolly.css" rel="stylesheet">
   <!-- <link rel="alternate" type="application/rss+xml" title="{{ site.name }}" href="{{ site.baseurl }}/blog/feed.xml"> -->

    <style>@import 'https://fonts.googleapis.com/css?family=Raleway:100,300';</style>
    
    <script type="text/javascript" src="dist/js/lively.lang.min.js"></script>
    <script type="text/javascript" src="dist/js/d3.v4.js"></script>
    <script type="text/javascript" src="scripts/chartObject.js"></script>
    <script type="text/javascript" src="scripts/scrollSteps.js"></script>

<script>
window.Global = window;

lively.pt = function pt(x, y) { return { x:x, y: y } }; // trivial, non-functional version

// the chartDefs function is expected to return one or more functions, each of which accepts a newly created chartObject and initialises it  
function startup() {
    chartDefs().forEach(initFn=>initFn(createChartObject()));
};

function chartDefs() { return [
    // for now, on a scrolly page we only expect a single vis definition.
    ch=>{
        var options = {
            stepDefinitions: scrollStepDefs(ch),
            visExtent: { x: 900, y: 745 }, // preferred, and max
            visMinExtent: { x: 500, y: 500 },
            textMinWidth: 300,
            textMaxWidth: 600,
            element: "vis",
            dataset: "mpg"
        };
        ch.initScrolliness(options);

        window.scrollyVis = ch;
        }
    ] }

function getVis() { return window.scrollyVis }

</script>
</head>


<body onload="startup()">

  <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
<!--           <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button> -->
          <a class="navbar-brand" href="#">Exploring Histograms, an essay by Aran Lunzer and Amelia McNamara (alpha release)</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
<!--           <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="#about">About</a></li>
            <li><a href="#contact">Contact</a></li>
          </ul> -->
        </div><!--/.nav-collapse -->
      </div>
    </nav>


<div class="container"> <!-- holds intro and scrolly parts.  fixed margins -->

<div id="intro">
		<h1 id="top">What's so hard about histograms?</h1>	
		<p class="lead">Histograms are a way to summarize a numeric variable. They use counts to aggregate similar values together and show you the overall distribution. However, they can be sensitive to parameter choices!</p>
      
    <p><i>April 2017: Please note the "alpha release" designation; this is a work in progress.  The interactive parts have so far been tested mainly on Chrome.</i></p>
        


	<h2>Visualizing distributions</h2>
	<div>	
		<p>When thinking about data, it is often useful to produce a plots of a variable to better understand the <b>distribution</b> of that variable. The way you visualize a distribution depends on whether the variable of interest is categorical or numeric.</p>

		<h3>Distributions of categorical variables</h3>
  <a class="thumbnail" style="float: right; margin: 0px 0px 15px 15px;" href="https://fivethirtyeight.com/features/a-statistical-analysis-of-the-work-of-bob-ross/"><img width="300px" src="img/hickey-ross-tags-1.png" class="img-responsive" alt="Bob Ross paintings containing the named elements"/></a>


    <p><b>Categorical</b> variables take on only on a few specific values. For example, gender is often reported as a categorical variable, perhaps with categories "male," "female," and "gender non-conforming." Racial categories are another common use of categorical variables.</p>

	

    <p>When a variable is categorical, the way to view the distribution of one variable is known as a <a href="http://www.bbc.co.uk/skillswise/factsheet/ma37grap-e3-f-reading-bar-charts">bar chart</a> or bar graph. Bar charts show how many items are counted in each of a set of categories. For example, fivethirtyeight used a bar chart to show <a href="https://fivethirtyeight.com/features/a-statistical-analysis-of-the-work-of-bob-ross/">the features of Bob Ross paintings</a>. The categories for painting elements are discrete choices, so Walt Hickey (the author of the chart) counted up how many paintings contained each element and displayed the <a href="#" data-toggle="tooltip" title="Technically, he really showed the percentages">counts</a>.</p>

    <p>Bar charts are not parameterized, which reduces the number of choices for the data analyst to make. As we will see, this is not the case for histograms.</p>
    
    <blockquote><p>There’s a strand of the data viz world that argues that everything could be a bar chart. That’s possibly true but also possibly a world without joy.</p>
      <p>-<a href="https://hbr.org/2013/03/power-of-visualizations-aha-moment">Amanda Cox</a>, The Upshot. </p></blockquote>

  <h3>Distributions of numeric variables</h3>
  

  <p><b>Numeric</b> variables are measured as numbers. For example, height is numeric, often measured in centimeters or inches. Age is numeric, measured in years or days. Numeric variables can be <b>discrete</b> or <b>continuous</b>. Discrete variables can only take on certain integer values. Continuous variables can take on any value along the number line.</p>

	

		<p>When a variable is numeric, there are a <a href="#" data-toggle="tooltip" title="Including boxplots, stem and leaf plots, and density plots">a variety of ways</a> to visualize the distribution, but the most common method is probably the histogram.</p>
    <p>For example, Justin Wolfers of The Upshot produced a histogram to <a href="https://www.nytimes.com/2014/04/23/upshot/what-good-marathons-and-bad-investments-have-in-common.html?rref=upshot&_r=1">visualize the finishing times of 10 million marathon finishers</a>.</p>

      <a class="thumbnail" style="float: right; margin: 0px 0px 15px 15px;" href="https://www.nytimes.com/2014/04/23/upshot/what-good-marathons-and-bad-investments-have-in-common.html?rref=upshot&_r=0"><img width="300px" src="img/0422-ups-marathon-945-1.png", class="img-responsive" alt="Marathon finishing times"/></a>

    <p>At first glance, this looks simple enough. We bin data into a set of discrete bins, then count how many values fall into each of the bins to aggregate the data. But, as we look closer we realize that there are actually many choices the data analyst needs to make in order to create a histogram, and the choices have big consequences on the resulting distribution!</p>

</div>
<br style="clear:both" />

</div>  <!-- end of #intro -->

<div id="scrolly">

<div id="sections">
<h2>Building a histogram</h2>

  <section class="step">
    <div class="title">Gather your data</div>
    The first step in building a histogram is to find some numeric data. We're going to start by considering the fuel mileage from a variety of cars sampled in 1974 (yes, this data is out of date). We can start by considering the dataset as a pool of items, each identified by its value. We can "see" all the data, but it is hard to get the gestalt of the variable. What are some common values? Is there a lot of variation? To answer these questions, we need to sort the data. 
  </section>
  <section class="step">
    <div class="title">Sort into an ordered list</div>
    A first step in being able to describe the distribution of the variable is to gather the items into a list, sorted by value. Now we can see the maximum value and the minimum value. Beyond that, it is hard to say much about the center, shape, and spread of the distribution. Part of the problem is that the list is completely filled&mdash;the space between two numbers is the same no matter how far apart the numbers are. We'd like to move these values appropriately so we can tell how sparse or clumpy they are. 
  </section>
  <section class="step">
    <div class="title">Draw the number line</div>
    A common convention is to use a number line, where higher values move to the right and smaller (or negative) values to the left. We can draw a line representing all possible numbers between the minimum and maximum data values.
  </section>
  <section class="step">
    <div class="title">Add data to the number line</div>
    <p>Now, we want to show each item as a dot at the appropriate point along the number line.  Here we draw a path connecting each item's position in the list to its position on the line, to highlight how adjacent items in the list will end up close or far apart on the number line depending on their values.</p>
    
    <p>In the first sample dataset ("mpg"), there are&mdash;by chance&mdash;no two items having exactly the same value. We have some other datasets available.  At an opposite extreme from "mpg" is "<span class="VisControlLink" onclick="getVis().switchDataset('nba')">nba</span>", a dataset comprising the ages of 105 NBA athletes.  Because ages are rounded to whole years, there end up being multiple items (i.e., multiple athletes) with the same age value.  We show repeated values by <b>stacking</b> them on top of each other on the number line.<p>
    
    <p>A third example dataset is "<span class="VisControlLink" onclick="getVis().switchDataset('faithful')">faithful</span>", a dataset of 272 timings (in seconds) between eruptions of the Old Faithful geyser in Yellowstone National Park.  Again, this dataset turns out to have some values for which there are multiple readings&mdash;and again, this multiplicity occurs because the values are being rounded to integers.  If the timings were measured to multiple decimal places (fanciful though that would be, for something as vague as an eruption onset), this dataset would almost certainly have no duplicates.  This is why counting items over a <i>range</i> of values&mdash;which is what histograms are all about&mdash;is useful in the first place.<p>
    
    <p>The buttons at the bottom of the visualisation allow you to switch between these datasets at any stage of the essay.<p>
  </section>
  <section class="step">
    <div class="title">Portioning items into bins&mdash;the essence of a histogram</div>
    <p>In these small datasets, the stacks of dots may give you a good sense of the distribution of the data. However, many real-world datasets have values which are repeated many hundreds or thousands of times. It becomes very hard to plot all the dots. Histograms provide a way to visualize data by aggregating it into bins, and they can be used with data of any size.</p>

    <p>Once items are placed along a number line, drawing a histogram involves sectioning the number line into <b>bins</b> and <b>counting</b> the items that fall into each bin. Notice how the distribution shown in the histogram echoes the distribution we could see in the dot plot.</p>

    <p>Perhaps because of their visual similarity to bar charts, histograms can appear very objective. But, unlike bar charts, histograms are governed by many <a href="https://em.wikipedia.org/wiki/Parameter" data-toggle="tooltip" title="Things that can be changed">parameters</a>.</p>
    
<!--     <p>The <span style="font-family:monospace">hist()</span> function in R will create a histogram for any dataset that you give it, using&mdash;unless you specify otherwise&mdash;default settings for the number and placement of the bins.  Here we show the default histogram that R would draw for this dataset.</p> -->
  </section>
  <section class="step">
    <div class="title">Why these bins?</div>
    <p>Many tools for working with data provide functionality to generate histograms, but most of them abstract away the defaults baked into the system. As a result, it is easy to come away with the belief that the histogram you generated is representative of the data, when in fact it is only one of a great number of possible histograms.</p>

    <p> For example, the statistical programming language <a href="https://www.r-project.org/">R</a> sets bin edges ("breaks") that are round numbers.  This certainly makes it easy to draw labels for the bins&mdash;and for the "<span class="VisControlLink" onclick="getVis().switchDataset('mpg')">mpg</span>" and "<span class="VisControlLink" onclick="getVis().switchDataset('nba')">nba</span>" datasets, the chosen breaks do cover the value ranges quite tidily.  But if you look at "<span class="VisControlLink" onclick="getVis().switchDataset('faithful')">faithful</span>" that first bin seems a bit arbitrary.  And it is.</p>


    <p>There are many algorithms for automatically choosing the number of bins in a histogram or the width of histogram bins. The <a href="https://en.wikipedia.org/wiki/Histogram#Sturges.27_formula">Sturges algorithm<a/> is a well-known method for choosing bin widths, but other algorithms include <a href="https://en.wikipedia.org/wiki/Histogram#Scott.27s_normal_reference_rule">Scott's choice</a> and the <a href="https://en.wikipedia.org/wiki/Freedman%E2%80%93Diaconis_rule">Freedman-Diaconis choice</a>. However, these are essentially just heuristics, and the generation of histograms should always involve human intervention.  </p>

    <p>No matter which parameters we choose, we're trying to answer the question "what is the distribution of this data like?" This is like trying to explain the distribution to someone over the phone. One way to convey the information would be to read the entire list of data and provide the exact values, but it is probably more salient to convey whether the distribution is symmetric, where it is centered, and whether it has extreme values. One question to ask when generating histograms is "How consistent is this description when we vary the parameters?"</p>

  </section>
  <section class="step">
    <div class="title">Shifting the bin offset</div>
    <p>Is the histogram that we created the only possible way to visualize this data? No. Is it the best? Maybe not.</p>

    <p>Watch what happens to the relative bin heights as we move the bins back and forth along the number line (changing the "bin offset"). Points are essentially being moved from one bin to another, changing the aggregation of height in the bins.</p>
    <p>The only thing we are varying is this offset. The data remains the same, the binwidth remains the same, but we nudge the edges in one direction or another. Some of the distributions look quite similar to one another, but occasionally a strangely different distribution will pop out.</p>
    <p>Mouse over the green dashed rectangle to slow down the animation.</p>
  </section>
  <section class="step">
    <div class="title">Shifting the bin width</div>
    <p>Another parameter we can vary is the width of the histogram bins. Now we fix the left end of the first bin to be equal to the minimum data value, and adjust the widths.</p>
    <p>Unlike offsets, some widths can be argued as being more valid than others.  For example, setting a width of 1.4 years for the "<span class="VisControlLink" onclick="getVis().switchDataset('nba')">nba</span>" dataset, where values are always integers, is asking for trouble: some bins will inevitably span two integer values, while others only include one.</p>
  </section>
  <section class="step">
    <div class="title">Unmasking the magic</div>
    <p>So far, we have only let you vary one parameter or another. However, there are interactions between parameters that can affect the shape of the distribution, and ways in which visualizing more of the parameter space can increase your knowlege of the distribution. This section allows you to see the "code" associated with our histogram creation.</p>

    <p>Try mousing over the values in the <b>width</b> row of the table to see a variety of histograms with different bin widths. 
    <p>The green square at the left side of the row will allow you to see a "sweep" of parameter values, creating a cloud of transparent histograms with slightly different bin widths. Turning on a sweep adds additional rows to the table. Try mousing over the table to see more information about how the heights of bins varies.</p>

    <p>Because broader bins generally capture more items, and narrower bins fewer, it can sometimes be hard to compare between histograms with different bin widths. One solution is to plot the histogram as <b>densities</b> rather than as counts. Use the radio button to toggle this option. Notice that the shape of the histogram does not change, but the labels on the axis do. Now you can more easily compare the shapes of histograms with different bin widths.</p>

    <p>Compare between a few of the sample datasets, and see if you can find histograms where changing the bin width changes the visual "center" of the distribution. 
  </section>
  <section class="step">
    <div class="title">More adjustments</div>
    <p>Now, we add an additional row so you can vary bin width and/or offset.</p>

    <p>Try setting up a sweep on binwidth, then varying the bin offset. Again, you may want to toggle the option to show density histograms for easier comparison.</p>

    <p>Sometimes, you may come across a set of parameter values that shows a vastly different shape for the distribution. Often, this is the result of a mismatch between the scale of the data and the scale of the bins. Several "stacks" of dots then get caught into a single bin in a way that might feel unexpected to a human.</p>

    
  </section>
  <section class="step">
    <div class="title">One more thing...</div>
    <p>We've been focusing on the effects of the bin offset and bin width, but there is at least one more relevant parameter&mdash;the "closedness" of the bins.  What happens to items that fall exactly on a boundary? Do they get counted as part of the bin on the left, or the one on the right?  Or both?</p>

    <p>It's not both - because that would mean that the boundary items were being counted twice. In a histogram, each data item must be assigned to exactly one bin.</p>

    <p>So, then: left or right? Again, tools to make visualizations will pick a default. In <a href="https://www.r-project.org/">R</a>, the default is left-open bins, whereas in <a href="https://stats.stackexchange.com/questions/51551/rounding-when-making-a-histogram">SAS and Stata</a>, the default is right-open. </p>

    <p>How much of a difference does this choice make?  Just as the impact of boundary position depends on the density of items in the vicinity of the boundaries, the impact of left- or right-closure of a histogram's intervals depends on how many items exactly match the boundary values.</p>

    <p>Try switching <b>open</b> from L to R.  Notice how the data points "jump" as they are moved from one bin to the next.</p>

    <p>In the previous section we pointed out that when the spacing of the bins isn't a pure multiple of the spacing of valid data values, some bins will end up covering more of the possible data values.  In such a case, it's easy to see that the relative item counts in the bins are likely to change depending on how the bin boundaries line up relative to the number line: shift all boundaries to the left, for example, and you'll also be shifting to the left the places where item counts happen to get clumped together.</p>

    <p>What if there's no mismatch between value spacing and bin width?  Can the bins' offset still make a difference to the shape of the histogram?  Yes!  Another effect seen in the previous section is when a concentration of items on nearby values - nearby, but not identical - could fall into a single bin, or could instead be split across two or more.  If all bins are shifted up or down the number line, the apportioning of values to bins in densely populated regions will of course change too.</p>


    
  </section>
  <section class="step">
    <div class="title">So what?</div>
    
    <p><i>(in the beta release we'll put this section somewhere better :-)</i></p>
    
<p>Hopefully, we have convinced you that histograms can be quite sensitive to parameter choices. It's never a good idea to accept the default bins provided to you by a visualization system, and if you see a histogram in the wild you should be interested in how the bins were chosen. Did the author pick the bins they are using in order to tell a particular story? Sometimes, authors "cherry-pick" parameter values to show a story that isn't really there in the data.</p>

<p>In our ideal world, people making histograms would understand how parameter choices affect what they create, and people reading histograms would have the opportunity to play with the parameters to convince themselves that the story they were seeing was robust.</p>

<p>We don't think that every histogram needs to be accompanied with all of the machinery you see in this essay, but some simple interactions can make it easy for people to interact with the parameters governing their histograms.</p>

<p>Here, we've made the controls much more lightweight. Drag a bin to adjust the bin offset, and watch the ghostly history of other histogram possibilities trail behind.Drag in the rectangle to adjust the bin width. To see a cloud of histograms, turn on "sweep bin offsets."</p>

<p>We've now made two larger datasets available for exploration.</p>

  <p>The first is "<span class="VisControlLink" onclick="getVis().switchDataset('diamonds')">diamonds</span>", a dataset that comes with the <a href="https://www.r-project.org/">R</a> package <a href="http://ggplot2.tidyverse.org/">ggplot2</a>. The full dataset includes information on 50,000 diamonds, but we have taken a subset of 1,000 less-expensive diamonds. Explore how the choice of bin width and bin offset change the shape, center, and spread of this distribution. (Can you find where the author of the package forgot a page of data?)</p>

  <p>The second larger dataset is "<span class="VisControlLink" onclick="getVis().switchDataset('marathon')">marathon</span>", a reference to the histogram of marathon finishing times we showed in the introduction. The  <a href="https://www.nytimes.com/2014/04/23/upshot/what-good-marathons-and-bad-investments-have-in-common.html?rref=upshot&_r=1">histogram</a> from the New York Times visualizes data on the finishing times of almost 10 million marathon finishers. Once again, we did not use the entire dataset, but rather sampled from <a href="http://faculty.chicagobooth.edu/george.wu/research/marathon/data.htm">the data</a> to take 2,000 finishers from the 2013 New York City marathon. With wide bins, the data looks roughly normally distributed&mdash;centered around 4 and a half hours, roughly symmetric. But, as you decrease the bin size the pattern described by Wolfers in the NYT article becomes apparenty&mdash;people aim for round numbers. Try hovering over some of the bins to get a sense for where those spikes occur.</p>

<p>We believe whenever you see a histogram, it should be possible to play with parameter values like this.</p>
</section>
  <section class="step">
    <div class="title">What tools allow for this functionality?</div>
<p>"Stretchy histograms" (those allowing users to adjust the binwidth dynamically) are available in a variety of commercially-available systems. In his 1997 paper, <a href="https://iase-web.org/documents/intstatreview/97.Biehler.pdf">Software for Learning and Doing Statistics</a>, Rolf Biehler talks about this feature in his software Statistics Workshop. Similar abilities were included in <a href="https://datadesk.com/">DataDesk</a>, <a href="http://fathom.concord.org/">Fathom</a>, and <a href="https://www.tinkerplots.com/">TinkerPlots</a>. However, many professional tools eschewed stretchy histograms (or even left histograms out altogether!). Excel <a href="https://support.office.com/en-us/article/Create-a-histogram-b6814e9e-5860-4113-ba51-e3a1b9ee1bbe">can be extended</a> to create histograms by the installation of a third-party add-on, but does not support stretchy histograms. Expert <a href="https://www.r-project.org/">R</a> users can create stretchy histograms using <a href="http://shiny.rstudio.com/">Shiny</a> or <a href="https://cran.r-project.org/web/packages/manipulate/manipulate.pdf">manipulate</a>, but even these do not offer direct manipulation, instead waiting for the user to drop a slider before updating the view. Similarly, <a href="">Tableau</a> makes it possible to generate a slider to update histogram parameters, but it is not simple.</p>

   <div class="title">Who we are</div>
    
    <p>Both of us (<a href="http://www.vpri.org/html/team_bios/aran_lunzer.htm">Aran Lunzer</a> and <a href="http://www.science.smith.edu/~amcnamara/">Amelia McNamara</a>) are interested in making it easier to see these types of choices. Lunzer's work focuses on "subjunctive interfaces," those that show you what <em>else</em> you might have seen, while McNamara is primarily interested in the effects of parameter choices on statistical visualizations.  We gratefully acknowledge the support of our many colleagues and collaborators, in particular within the <a href="http://harc.ycr.org">Human Advancement Research Community</a>.</p>
    
    <p>This essay is built using styling borrowed from <a href="http://getbootstrap.com/">Bootstrap</a>, with scrolly behaviour derived from Jim Vallandingham's <a href="http://vallandingham.me/scroller.html">So You Want to Build A Scroller</a>.  The interactive visualisations make extensive use of <a href="https://d3js.org/">D3.js</a>, and utility functions from <a href="https://github.com/LivelyKernel/lively.lang/">lively.lang</a>. While the code was primarily generated to power this essay, it is <a href="https://github.com/AmeliaMN/histogram_essay">available on GitHub</a> if you want to play with it yourself.</p>
    
  </section>
  
</div>
<div id='vis'>
</div>

</div> <!-- end of #scrolly -->

<div id="extra-space"></div>

<p>
    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a><br />This work, by <a href="http://www.vpri.org/html/team_bios/aran_lunzer.htm">Aran Lunzer</a> and <a href="http://www.science.smith.edu/~amcnamara/">Amelia McNamara</a>, is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.

<br />
</p>

<!-- https://stats.stackexchange.com/questions/51551/rounding-when-making-a-histogram -->

</div> <!-- end of .container -->

  </body>
</html>